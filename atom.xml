<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title></title>
    <subtitle>rantbox</subtitle>
    <link href="https://100phlecs.github.io/atom.xml" rel="self" type="application/atom+xml"/>
    <link href="https://100phlecs.github.io"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2023-10-05T00:00:00+00:00</updated>
    <id>https://100phlecs.github.io/atom.xml</id>
    <entry xml:lang="en">
        <title>Cleaning up old Elixir code</title>
        <published>2023-10-05T00:00:00+00:00</published>
        <updated>2023-10-05T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://100phlecs.github.io/blog/cleaning-up-old-code/" type="text/html"/>
        <id>https://100phlecs.github.io/blog/cleaning-up-old-code/</id>
        
        <content type="html">&lt;p&gt;It’s been awhile since I last looked at the &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;100phlecs&#x2F;tailwind_formatter&quot;&gt;&lt;code&gt;TailwindFormatter&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; library.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;TailwindFormatter&lt;&#x2F;code&gt; is a &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;hexdocs.pm&#x2F;mix&#x2F;main&#x2F;Mix.Tasks.Format.html#module-plugins&quot;&gt;Mix Format&lt;&#x2F;a&gt; extension to sort TailwindCSS classes with a few divergences. &lt;&#x2F;p&gt;
&lt;p&gt;Naively I went for the Regex approach. The algorithm went something like:&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;Fetch all class attributes with a complex Regex&lt;&#x2F;li&gt;
&lt;li&gt;Within that, validate and substitute all Elixir code&lt;&#x2F;li&gt;
&lt;li&gt;Sort the variants and classes in layers&lt;&#x2F;li&gt;
&lt;li&gt;Put back the Elixir functions&lt;&#x2F;li&gt;
&lt;li&gt;Add additional ASCII to properly swap it out&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;Here are the four regex patterns the library uses to find classes:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;class_pattern&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;~r&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-interpolated z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-non-capturing-group z-regexp z-elixir&quot;&gt;?:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;c&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;l&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;a&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;s&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;s&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-escape-sequence z-regexp z-elixir&quot;&gt;\s&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-non-capturing-group z-regexp z-elixir&quot;&gt;?:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-escape-sequence z-regexp z-elixir&quot;&gt;\s&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-other z-any z-regexp z-elixir&quot;&gt;.&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-escape-sequence z-regexp z-elixir&quot;&gt;\s&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*?&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-conditional z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-conditional z-regexp z-elixir&quot;&gt;?&lt;span class=&quot;z-punctuation z-definition z-conditional z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-conditional z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-invalid z-illegal z-conditional z-regexp z-elixir&quot;&gt;2&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-conditional z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-conditional z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\}&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-modifiers z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;i&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;inline_func_pattern&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;~r&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-interpolated z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;#&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-non-capturing-group z-regexp z-elixir&quot;&gt;?:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-non-capturing-group z-regexp z-elixir&quot;&gt;?:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-assertion z-regexp z-elixir&quot;&gt;?!&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;#&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\{&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-other z-any z-regexp z-elixir&quot;&gt;.&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-alternation z-regexp z-elixir&quot;&gt;|&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-other z-subroutine z-regexp z-elixir&quot;&gt;(?&lt;span class=&quot;z-variable z-other z-subroutine z-regexp z-elixir&quot;&gt;R&lt;&#x2F;span&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\}&lt;&#x2F;span&gt;&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-modifiers z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;i&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;dynamic_classes&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;~r&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-interpolated z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-begin z-regexp z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-set z-posix z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-set z-posix z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-posix-class z-begin z-regexp z-elixir&quot;&gt;[:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-posix-class z-name z-regexp z-elixir&quot;&gt;alnum&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-set z-posix z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-posix-class z-end z-regexp z-elixir&quot;&gt;:]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;-&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-end z-regexp z-elixir&quot;&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;#&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-begin z-regexp z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-begin z-regexp z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-negation z-regexp z-elixir&quot;&gt;^&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-end z-regexp z-elixir&quot;&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;+&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-group z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-group z-end z-regexp z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\}&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;*&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-modifiers z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;i&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;invalid_input&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-storage z-type z-string z-elixir&quot;&gt;~r&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-interpolated z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-begin z-regexp z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-negation z-regexp z-elixir&quot;&gt;^&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;_&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;a&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-range z-regexp z-elixir&quot;&gt;-&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;z&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;A&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-range z-regexp z-elixir&quot;&gt;-&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;Z&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;0&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-character-range z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-range z-regexp z-elixir&quot;&gt;-&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-range z-regexp z-elixir&quot;&gt;9&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\$&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-escape-sequence z-regexp z-elixir&quot;&gt;\s&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\-&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-literal z-regexp z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\[&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\]&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-dot z-regexp z-elixir&quot;&gt;\.&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-character z-escape z-regexp z-elixir&quot;&gt;\#&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-set z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-set z-end z-regexp z-elixir&quot;&gt;]&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-quantifier z-regexp z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-quantifier z-regexp z-elixir&quot;&gt;+&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&#x2F;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Pretty complicated…&lt;&#x2F;p&gt;
&lt;p&gt;Since the &lt;code&gt;class&lt;&#x2F;code&gt; attribute within a Phoenix template can hold any valid Elixir expression, one can conclude this isn’t sustainable. &lt;&#x2F;p&gt;
&lt;p&gt;The solution is to use the Phoenix tokenizers and handle the AST representation of each &lt;code&gt;class&lt;&#x2F;code&gt;. 
So I took the time and converted the library over to use the Phoenix tokenizers. It’s a lot simpler, but I wouldn’t entirely attribute it to the different approach. 
After programming in Elixir for awhile, I found some of my previous code easier to clean up.&lt;&#x2F;p&gt;
&lt;p&gt;Here’s the new entry point of the plugin:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;  &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;def&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-public z-elixir&quot;&gt;format&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;contents&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _opts&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
    contents
    &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;HEExTokenizer&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;tokenize&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;reduce&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;]&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;collect_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;2&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;reduce&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;contents&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;sort_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;2&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;collect_classes&lt;&#x2F;code&gt; is pretty straightforward:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;  &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;collect_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-symbol z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-constant z-elixir&quot;&gt;:&lt;&#x2F;span&gt;tag&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _name&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; attrs&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _meta&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; acc&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;case&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;find&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;attrs&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &amp;amp;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;elem&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;0&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;==&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;class&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;do&lt;&#x2F;span&gt;
      &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;class&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; class&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _meta&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arrow z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;[&lt;&#x2F;span&gt;class &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;|&lt;&#x2F;span&gt; acc&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;]&lt;&#x2F;span&gt;
      &lt;span class=&quot;z-constant z-language z-elixir&quot;&gt;nil&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arrow z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; acc
    &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;sort_classes&lt;&#x2F;code&gt; goes more into the AST stuff which I won’t go through. What it does is that it handles things like:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;div class&lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;grid-cols-&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;&lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;num&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;-custom bg-red-300&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;gt;&lt;&#x2F;span&gt; 
&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;div class&lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;if&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;active&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-other z-keywords z-elixir&quot;&gt;do&lt;span class=&quot;z-punctuation z-definition z-constant z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;bg-red-50&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-other z-keywords z-elixir&quot;&gt;else&lt;span class=&quot;z-punctuation z-definition z-constant z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;hidden&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt; h-10 w-full leading-5&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;gt;&lt;&#x2F;span&gt; 
&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;div class&lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;h-6 &lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-binary-concatenation z-elixir&quot;&gt;&amp;lt;&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;if&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-module z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-definition z-constant z-elixir&quot;&gt;@&lt;&#x2F;span&gt;active&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-other z-keywords z-elixir&quot;&gt;do&lt;span class=&quot;z-punctuation z-definition z-constant z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;font-bold&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-comparison z-elixir&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Elixir expressions.&lt;&#x2F;p&gt;
&lt;p&gt;Instead, let’s go to the part where it sorts the &lt;code&gt;class&lt;&#x2F;code&gt; string, something like:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;html&quot; class=&quot;language-html z-code&quot;&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;z-text z-html z-basic&quot;&gt;&lt;span class=&quot;z-meta z-tag z-block z-any z-html&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-tag z-begin z-html&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-entity z-name z-tag z-block z-any z-html&quot;&gt;div&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-attribute-with-value z-class z-html&quot;&gt;&lt;span class=&quot;z-entity z-other z-attribute-name z-class z-html&quot;&gt;class&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-key-value z-html&quot;&gt;=&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-quoted z-double z-html&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-html&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-string z-quoted z-double z-html&quot;&gt;&lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;h-8&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;w-8&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;bg-slate-500&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;md:w-16&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;md:h-12&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-class-name z-html&quot;&gt;lg:flex&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-html&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-tag z-end z-html&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-meta z-tag z-block z-any z-html&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-tag z-begin z-html&quot;&gt;&amp;lt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-entity z-name z-tag z-block z-any z-html&quot;&gt;div&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-tag z-end z-html&quot;&gt;&amp;gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Here’s the previous &lt;code&gt;sort&lt;&#x2F;code&gt; function entry point:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;]&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;[&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-array z-elixir&quot;&gt;]&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;

&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; base_classes&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; separate&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  base_sorted &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; sort_base_classes&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  variant_sorted &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; sort_variant_classes&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;

  base_sorted &lt;span class=&quot;z-keyword z-operator z-list-manipulation z-elixir&quot;&gt;++&lt;&#x2F;span&gt; variant_sorted
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;For those unfamiliar with Elixir, the above is pattern matching on the function parameter. It goes in declaration order. So in this case, if the parameter passed matches &lt;code&gt;[]&lt;&#x2F;code&gt; it goes to the first function, returning a &lt;code&gt;[]&lt;&#x2F;code&gt;. Otherwise it continues to check against the other functions.&lt;&#x2F;p&gt;
&lt;p&gt;Let’s look at &lt;code&gt;sort_base_classes(base_classes)&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_base_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  base_classes
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; class &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    sort_number &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; get_sort_position&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;sort_number&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; class&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;elem&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;0&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;elem&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This was poorly written, and was written by me. You can reduce this down to:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;class_position&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I’m not sure why I thought I had to explicitly store the position of the class in order to sort it. But it isn’t needed at all.&lt;&#x2F;p&gt;
&lt;p&gt;Another example is &lt;code&gt;sort_variant_classes&lt;&#x2F;code&gt;. It’s a large chain of functions, bear with me:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_variant_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variants
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; group_by_first_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; sort_variant_groups&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; sort_classes_per_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; grouped_variants_to_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;

&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;group_by_first_variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variants
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&amp;amp;&lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;String&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;split&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;:&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-other z-keywords z-elixir&quot;&gt;parts&lt;span class=&quot;z-punctuation z-definition z-constant z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;2&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;group_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&amp;amp;&lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;List&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;first&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &amp;amp;&lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;List&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;last&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;

&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_variant_groups&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variant_groups&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variant_groups
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; variant_group &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    variant &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; elem&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variant_group&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;0&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
    sort_number &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Map&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;get&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Defaults&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;variant_order&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; variant&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;-&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;

    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;sort_number&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; variant_group&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;elem&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;0&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;elem&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;

&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_classes_per_variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; variant_group &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; classes_and_variants&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; variant_group
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; sort&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;classes_and_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;

&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;grouped_variants_to_list&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;flat_map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; variant_group &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; base_classes&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; variant_group

    &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; class &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
      &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;class&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Looking at the previous example of &lt;code&gt;sort_base_classes()&lt;&#x2F;code&gt; you may notice the same poorly written pattern in &lt;code&gt;sort_variant_groups()&lt;&#x2F;code&gt;. Let’s scrap that function entirely:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_variant_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variants
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; group_by_first_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; variant_position&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; sort_classes_per_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; grouped_variants_to_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Much simpler and a whole lot more explicit too. I think you only want to use &lt;code&gt;elem()&lt;&#x2F;code&gt; when you’re dealing with larger tuples. It’s better to pattern match against the tuple, and reads a lot easier.&lt;&#x2F;p&gt;
&lt;p&gt;Next on the list is &lt;code&gt;sort_classes_per_variant()&lt;&#x2F;code&gt;:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_classes_per_variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; variant_group &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; classes_and_variants&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; variant_group
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; sort&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;classes_and_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This function is pointlessly verbose. Maybe I didn’t know about pattern matching in the anonymous function call yet? Not sure.&lt;&#x2F;p&gt;
&lt;p&gt;Let’s delete that one too:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_variant_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variants
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; group_by_first_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; variant_position&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; sort&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;rest&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; grouped_variants_to_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;And finally, &lt;code&gt;grouped_variants_to_list()&lt;&#x2F;code&gt;. Let’s look at it once more:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;grouped_variants_to_list&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;flat_map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;grouped_variants&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; variant_group &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; base_classes&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; variant_group

    &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; class &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt;
      &lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;class&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
    &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This one is okay. It’s verbose and unnecessarily pattern matches within the function call, but it isn’t too horrible compared to the others. We can use the same logic, just reduce it down a bit more.&lt;&#x2F;p&gt;
&lt;p&gt;Here’s the final implementation of &lt;code&gt;sort_variant_classes()&lt;&#x2F;code&gt;:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort_variant_classes&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  variants
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; group_by_first_variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; _rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; variant_position&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; sort&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;rest&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-keyword z-operator z-pipe z-elixir&quot;&gt;|&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;flat_map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;fn&lt;&#x2F;span&gt; &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variant&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; rest&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-other z-elixir&quot;&gt;-&amp;gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;map&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;rest&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &amp;amp;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-begin z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;variant&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;:&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-begin z-elixir&quot;&gt;#{&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-interpolation z-elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir z-embedded&quot;&gt;&lt;span class=&quot;z-constant z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;1&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-interpolation z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-string z-elixir&quot;&gt;&lt;span class=&quot;z-string z-quoted z-double z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-definition z-string z-end z-elixir&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;We deleted roughly ~25 lines of code by taking advantage of function pattern matching.&lt;&#x2F;p&gt;
&lt;p&gt;Here’s how the regular sort function looks now:&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;elixir&quot; class=&quot;language-elixir z-code&quot;&gt;&lt;code class=&quot;language-elixir&quot; data-lang=&quot;elixir&quot;&gt;&lt;span class=&quot;z-source z-elixir&quot;&gt;&lt;span class=&quot;z-meta z-function z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;defp&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-function z-private z-elixir&quot;&gt;sort&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-definition z-parameters z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-elixir&quot;&gt;when&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-guard z-elixir&quot;&gt;is_list&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class_list&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-control z-module z-elixir&quot;&gt;do&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;
  &lt;span class=&quot;z-meta z-sequence z-tuple z-elixir&quot;&gt;&lt;span class=&quot;z-punctuation z-section z-sequence z-begin z-elixir&quot;&gt;{&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-separator z-sequence z-elixir&quot;&gt;,&lt;&#x2F;span&gt; base_classes&lt;span class=&quot;z-punctuation z-section z-sequence z-end z-elixir&quot;&gt;}&lt;&#x2F;span&gt;&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-assignment z-elixir&quot;&gt;=&lt;&#x2F;span&gt; &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;split_with&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;class_list&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &amp;amp;variant?&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;

  &lt;span class=&quot;z-entity z-name z-class z-elixir&quot;&gt;Enum&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-separator z-method z-elixir&quot;&gt;.&lt;&#x2F;span&gt;sort_by&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;base_classes&lt;span class=&quot;z-punctuation z-separator z-object z-elixir&quot;&gt;,&lt;&#x2F;span&gt; &lt;span class=&quot;z-variable z-other z-capture z-elixir&quot;&gt;&lt;span class=&quot;z-keyword z-operator z-capture z-elixir&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;class_position&lt;&#x2F;span&gt;&lt;span class=&quot;z-keyword z-operator z-arithmetic z-elixir&quot;&gt;&#x2F;&lt;&#x2F;span&gt;&lt;span class=&quot;z-constant z-numeric z-elixir&quot;&gt;1&lt;&#x2F;span&gt;&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt; &lt;span class=&quot;z-keyword z-operator z-list-manipulation z-elixir&quot;&gt;++&lt;&#x2F;span&gt; sort_variant_classes&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;(&lt;&#x2F;span&gt;variants&lt;span class=&quot;z-punctuation z-section z-function z-elixir&quot;&gt;)&lt;&#x2F;span&gt;
&lt;span class=&quot;z-keyword z-control z-elixir&quot;&gt;end&lt;&#x2F;span&gt;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Some may argue that the temporary variable names added clarity, and I’m not entirely sure. 
I like the less noise in this version, but maybe as I program more I will find myself thinking otherwise.&lt;&#x2F;p&gt;
&lt;p&gt;In conclusion, the old approach was messy regex and substitutions. The new version &lt;em&gt;still&lt;&#x2F;em&gt; has substitutions, but this time it’s on the AST. The new algorithm:&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;Parse the tree using Phoenix tokenizer&lt;&#x2F;li&gt;
&lt;li&gt;Grab all class attributes&lt;&#x2F;li&gt;
&lt;li&gt;For class attributes that are strings, pass to &lt;code&gt;sort()&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;For class attributes that are expressions, transform to AST and handle each expression type.&lt;&#x2F;li&gt;
&lt;li&gt;Render the new sorted string, and substitute it back into the contents.&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;Expression types can be concatenations (&lt;code&gt;&amp;lt;&amp;gt;&lt;&#x2F;code&gt;) or interpolations (&lt;code&gt;#{@active}&lt;&#x2F;code&gt;). Arrays too (which I’ve yet to add support for, but it’s coming up now that there’s an AST to work with).&lt;&#x2F;p&gt;
&lt;p&gt;Some of the expression &lt;code&gt;class&lt;&#x2F;code&gt; code is a little complicated. 
I imagine in time there can be another blog post like this that points out inefficiencies.&lt;&#x2F;p&gt;
&lt;p&gt;Besides support for arrays, I also want to support the &lt;code&gt;tailwind.config.js&lt;&#x2F;code&gt; file of the project. Not sure yet how to execute the JS code that extracts the classes from it. Will see.&lt;&#x2F;p&gt;
&lt;p&gt;Maintenance work can sometimes be grueling, but also satisfying too.&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>How I deal with QWERTY</title>
        <published>2023-09-26T00:00:00+00:00</published>
        <updated>2023-09-26T00:00:00+00:00</updated>
        <author>
          <name>Unknown</name>
        </author>
        <link rel="alternate" href="https://100phlecs.github.io/blog/custom-macos-keys/" type="text/html"/>
        <id>https://100phlecs.github.io/blog/custom-macos-keys/</id>
        
        <content type="html">&lt;p&gt;With a bit of research you won’t be surprised to find the QWERTY layout is inefficient. A knee-jerk reaction would be to learn an alternative layout, which I did to some extent. But then one will inevitably discover all of the other inefficiencies attached to keyboard design. And the exhaustion found in “catching up” toward nowhere.&lt;&#x2F;p&gt;
&lt;p&gt;I bought new keyboards, optimized my layouts further, introduced different “layers” the same way the &lt;code&gt;Shift&lt;&#x2F;code&gt; key is a layer for capitals. Though in the name of preventing hand injury, how the time adds up toward little profit. Here I was diligently practicing a skill I technically already had, just under new terms, for the marginal gain of typing either quicker or less strenuously. I’ve since given up (almost) entirely on the ordeal. Here is my Atreus keyboard which is collecting dust.&lt;&#x2F;p&gt;
&lt;figure&gt;
  &lt;img src=&quot;&#x2F;images&#x2F;atreus.png&quot; alt=&quot;atreus keyboard&quot;&#x2F;&gt;
  &lt;figcaption&gt;I wiped off the dust for this photo. You can see some residual between the keys.&lt;&#x2F;figcaption&gt;
&lt;&#x2F;figure&gt;
&lt;p&gt;One could critique the way in which I approached it all–I completely agree. I fell into the trap anyone does when they begin to question The Defaults: &lt;em&gt;the endless alternatives and the quest to find the perfect one&lt;&#x2F;em&gt;. It’s overwhelming. One may find some similarity in the equally nauseating quest of finding the “perfect” stack. &lt;&#x2F;p&gt;
&lt;p&gt;If you enjoy such quests, then you have much to look forward to with computers and keyboards. But if you’re in the no-fun zone like me, or a no-fun zoner in denial (there are many), such quests only serve to frustrate and distract from more interesting stuff. Like actually writing posts or software.&lt;&#x2F;p&gt;
&lt;p&gt;So as a no-fun zoner what have I settled on for my keyboard “experience”? If you are a professional pixel-pusher there’s still an underlying incentive to do something about the defaults, unless you enjoy &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Repetitive_strain_injury&quot;&gt;RSI&lt;&#x2F;a&gt;. &lt;&#x2F;p&gt;
&lt;p&gt;Well, I stick with QWERTY and basic QWERTY keyboards, for one. And finally, I use &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;karabiner-elements.pqrs.org&#x2F;&quot;&gt;Karabiner Elements&lt;&#x2F;a&gt; for some quality of life modifications. More specifically, I use &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;github.com&#x2F;yqrashawn&#x2F;GokuRakuJoudo#gokurakujoudo&quot;&gt;goku&lt;&#x2F;a&gt;. To this day I do not know how to write native configs for Karabiner, and I hope I never have to.&lt;&#x2F;p&gt;
&lt;p&gt;There are only two essential modifications I use which I would recommend to anyone that uses Emacs keybindings. &lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;Map &lt;code&gt;Right Command&lt;&#x2F;code&gt; to &lt;code&gt;Control&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;Map &lt;code&gt;Caps Lock&lt;&#x2F;code&gt; to &lt;code&gt;Hyper&lt;&#x2F;code&gt;&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#1&quot;&gt;1&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;The first modification makes it easy to use Emacs shortcuts as it’s now a thumb press. The second modification allows me to use a layer to access hard-to-reach symbols by mapping them on letter-keys, thereby reducing strain.&lt;&#x2F;p&gt;
&lt;p&gt;Finally, and most importantly, I repurpose both &lt;code&gt;Caps Lock&lt;&#x2F;code&gt; and &lt;code&gt;Right Command&lt;&#x2F;code&gt; depending on the type of key press. If the keys are held, you have the above mappings.&lt;&#x2F;p&gt;
&lt;p&gt;If they are tapped, however:&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Right Command&lt;&#x2F;code&gt; -&amp;gt; &lt;code&gt;_&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;code&gt;Caps Lock&lt;&#x2F;code&gt; -&amp;gt; &lt;code&gt;Esc&lt;&#x2F;code&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;I often program in &lt;a rel=&quot;noopener&quot; target=&quot;_blank&quot; href=&quot;https:&#x2F;&#x2F;en.wikipedia.org&#x2F;wiki&#x2F;Snake_case&quot;&gt;Snake case&lt;&#x2F;a&gt; languages. Pressing shift and reaching for &lt;code&gt;_&lt;&#x2F;code&gt; gets old and causes strain. Having easy access to underscore with a thumb press feels natural, like pressing the space bar, and has made programming far easier on me.&lt;&#x2F;p&gt;
&lt;figure&gt;
  &lt;img src=&quot;&#x2F;images&#x2F;keyboard.png&quot; alt=&quot;current keyboard&quot;&#x2F;&gt;
  &lt;figcaption&gt;My current keyboard. Chosen because it just works and is small.&lt;&#x2F;figcaption&gt;
&lt;&#x2F;figure&gt;
&lt;p&gt;A caveat to these dual-mappings is accidental mix-ups between the underscore and the control. When I write too quickly, my intended underscore may register as a Control instead, and therefore trigger an Emacs command (i.e. ctrl+a). &lt;&#x2F;p&gt;
&lt;p&gt;Sometimes there are inefficiencies that you will accept because the alternatives are too complex to bother with and&#x2F;or setup. This is precisely why I quit using Emacs. As well as NeoVim. I’ve forever cemented myself as a plebeian to the Config Confederation and may no longer participate in the round table of plugins. &lt;&#x2F;p&gt;
&lt;p&gt;As a trade off, I only have a few conceptual dotfiles to take along with me. 
Emacs keybindings, some key mappings, and that’s it. 
Shouldn’t take too much to configure a new computer from scratch.&lt;&#x2F;p&gt;
&lt;p&gt;It’s a central question really: &lt;em&gt;is customization worth the time?&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;My answer: &lt;em&gt;in small doses.&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;
&lt;p&gt;You have my answer, and you are entirely welcome to yours. &lt;&#x2F;p&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;1&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;1&lt;&#x2F;sup&gt;
&lt;p&gt;&lt;code&gt;Hyper&lt;&#x2F;code&gt; is a combination of modifier keys on MacOS. My Hyper is defined as &lt;code&gt;Option&lt;&#x2F;code&gt;, &lt;code&gt;Command&lt;&#x2F;code&gt;, and &lt;code&gt;Shift&lt;&#x2F;code&gt; pressed at the same time. The official &lt;code&gt;Hyper&lt;&#x2F;code&gt; definition includes the &lt;code&gt;Control&lt;&#x2F;code&gt; key too. I forgot why I removed &lt;code&gt;Control&lt;&#x2F;code&gt; from the definition. Vaguely recall that it was due to some conflict with native MacOS keybindings.&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
</content>
        
    </entry>
</feed>
